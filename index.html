<!DOCTYPE html>
<html lang="hy">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Գտիր քո սեղանը</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
<style>
  body { 
    font-family: 'Roboto', sans-serif; 
    margin:0; 
    padding:0; 
    background: linear-gradient(to bottom, #4b0000, #1a0000); 
    color:#fff; 
    display:flex; 
    flex-direction:column; 
    align-items:center; 
    min-height:100vh;
  }
  h1 { 
    text-align:center; 
    margin:30px 10px 20px 10px; 
    font-weight:700; 
    font-size:2rem;
  }
  #search { 
    width:90%; 
    max-width:500px; 
    padding:12px 20px; 
    font-size:1.1rem; 
    border-radius:25px; 
    border:none; 
    margin-bottom:20px; 
    box-sizing:border-box;
  }
  #results { 
    width:90%; 
    max-width:500px; 
    display:flex; 
    flex-direction:column; 
    gap:10px;
  }
  .row { 
    display:flex; 
    justify-content:space-between; 
    align-items:center; 
    padding:12px 20px; 
    background-color: rgba(255,255,255,0.1); 
    border-radius:15px; 
    word-break: break-word; 
    font-size:1rem;
  }
  .table { 
    color:#800020; 
    font-weight:700; 
  }
  @media (max-width:400px){ 
    #search, .row{ font-size:0.9rem; padding:10px 15px;}
  }
</style>
</head>
<body>

<h1>Գտիր քո սեղանը</h1>
<input type="text" id="search" placeholder="Գրիր քո անունը" oninput="search(this.value)" />
<div id="results"></div>

<script src="https://cdn.jsdelivr.net/npm/opensheet.elk@1.0.2/dist/opensheet.min.js"></script>
<script>
let guests = [];

// Փոխարինիր այստեղ Google Sheet-ի ID-ով
const sheetID = "1GF1ARQ52zejxKaIpS2At_D87OWhq92PYzVYCynDnItY"; // URL-ում `d/` և `/edit` միջև մասը

// Խնայում ենք բոլոր տվյալները
OpenSheet({ sheetId: sheetID, sheet: "Sheet1", format: "json" })
  .then(data => { guests = data; })
  .catch(err => {
    console.error("Շիթը չի բացվում:", err);
    document.getElementById("results").innerHTML = "<div class='row'>Շիթը չի հասանելի</div>";
  });

function search(value){
  const input = value.toLowerCase().trim();
  const result = document.getElementById("results");
  result.innerHTML = "";

  if(input === "") return; // անունը ջնջելուց ցանկը չի երևա

  const matches = guests.filter(g =>
    (g.Name && g.Name.toLowerCase().includes(input)) ||
    (g.Հայերեն_Անուն && g.Հայերեն_Անուն.toLowerCase().includes(input))
  );

  if(matches.length === 0){
    result.innerHTML = "<div class='row'>Սեղան չի գտնվել</div>";
    return;
  }

  matches.forEach(g => {
    result.innerHTML += `
      <div class="row">
        <span>${g.Name ? g.Name : ""}${g.Հայերեն_Անուն ? " | " + g.Հայերեն_Անուն : ""}</span>
        <span class="table">Սեղան ${g.Table}</span>
      </div>
    `;
  });
}
</script>
</body>
</html>
